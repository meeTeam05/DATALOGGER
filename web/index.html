<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHT31 Temperature Monitor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå°Ô∏è Temperature & Humidity Monitor</h1>
            <p>Real-time Monitoring Dashboard</p>
            
            <!-- MQTT Connection Status -->
            <div class="mqtt-status">
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="statusText">MQTT Disconnected</span>
                </div>
                <div class="connection-status" id="firebaseStatus">
                    <span class="status-dot" id="firebaseDot"></span>
                    <span id="firebaseText">Firebase Disconnected</span>
                </div>
                <button class="settings-btn" id="settingsBtn">‚öôÔ∏è</button>
            </div>
        </div>

        <!-- MQTT Configuration Modal -->
        <div class="modal" id="mqttModal">
            <div class="modal-content">
                <h3>Configuration Settings</h3>
                
                <!-- MQTT Settings -->
                <h4>MQTT Broker Configuration</h4>
                <div class="config-group">
                    <label for="mqttIp">IP Address:</label>
                    <input type="text" id="mqttIp" value="127.0.0.1" placeholder="192.168.1.100">
                </div>
                <div class="config-group">
                    <label for="mqttPort">WebSocket Port:</label>
                    <input type="text" id="mqttPort" value="8083" placeholder="8083">
                </div>
                <div class="config-group">
                    <label for="mqttPath">WebSocket Path:</label>
                    <input type="text" id="mqttPath" value="/mqtt" placeholder="/mqtt">
                </div>
                <div class="config-group">
                    <label for="mqttUser">Username:</label>
                    <input type="text" id="mqttUser" value="DataLogger" placeholder="Required by broker">
                </div>
                <div class="config-group">
                    <label for="mqttPass">Password (optional):</label>
                    <input type="password" id="mqttPass" placeholder="Leave empty if no password">
                </div>

                <!-- Firebase Settings -->
                <h4>Firebase Configuration</h4>
                <div class="config-group">
                    <label for="firebaseUrl">Firebase Database URL:</label>
                    <input type="text" id="firebaseUrl" placeholder="https://your-project.firebaseio.com">
                </div>
                <div class="config-group">
                    <label for="firebaseApiKey">API Key:</label>
                    <input type="text" id="firebaseApiKey" placeholder="Your Firebase API Key">
                </div>
                <div class="config-group">
                    <label for="firebaseProject">Project ID:</label>
                    <input type="text" id="firebaseProject" placeholder="your-project-id">
                </div>

                <div class="modal-buttons">
                    <button class="cancel-btn" id="cancelBtn">Cancel</button>
                    <button class="save-btn" id="saveBtn">Save & Connect</button>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Frame Rate (Hz)</label>
                <div class="frame-selector">
                    <button class="frame-btn" data-rate="0.5">0.5</button>
                    <button class="frame-btn active" data-rate="1">1</button>
                    <button class="frame-btn" data-rate="2">2</button>
                    <button class="frame-btn" data-rate="4">4</button>
                    <button class="frame-btn" data-rate="10">10</button>
                </div>
            </div>
            
            <div class="control-group">
                <label>Operating Mode</label>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                    <button class="mode-btn" id="periodicBtn">Periodic</button>
                    <button class="mode-btn stop-btn" id="stopBtn" style="display: none;">Stop</button>
                    <button class="mode-btn single-btn" id="singleBtn">Single Read</button>
                </div>
            </div>
            
            <div class="control-group">
                <label>Device Control</label>
                <button class="device-btn" id="deviceBtn">DEVICE OFF</button>
            </div>

            <div class="control-group">
                <label>Data Management</label>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                    <button class="data-btn" id="loadDataBtn">Load History</button>
                    <button class="data-btn" id="clearDataBtn">Clear Charts</button>
                </div>
            </div>
        </div>

        <div class="current-display" id="currentDisplay">
            Current: --¬∞C & --% RH
        </div>
        
        <div class="status-display" id="statusDisplay">
            <div class="status-item">[INIT] SHT31 Temperature Monitor Started</div>
            <div class="status-item">[INFO] System ready for data acquisition</div>
            <div class="status-item status-warning">[WARNING] Configure Firebase for data persistence</div>
        </div>

        <div class="charts-container">
            <div class="chart-wrapper">
                <div class="chart-header">
                    <div class="chart-title">üå°Ô∏è Temperature</div>
                    <div class="chart-stats" id="tempStats">Min: -- | Max: -- | Avg: --</div>
                </div>
                <canvas id="tempChart1" width="400" height="200"></canvas>
            </div>
            
            <div class="chart-wrapper">
                <div class="chart-header">
                    <div class="chart-title">üíß Humidity</div>
                    <div class="chart-stats" id="humiStats">Min: -- | Max: -- | Avg: --</div>
                </div>
                <canvas id="tempChart2" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>